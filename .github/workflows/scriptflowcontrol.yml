name: script-executor


on:
  workflow_dispatch:
    inputs:
      Select:
        description: "Provide Scripts which need to be ignored during execution"
        type: boolean
        default: false
      Preview:
        description: "scipt"
        type: boolean
        default: false
      Preview_2:
        description: "scipt_2"
        type: boolean
        default: false  
jobs:
      
  Select:
    if: ${{ inputs.Select }}
    runs-on: ubuntu-latest
    steps:
      - name: print
        run:  |
          for i in "${array[@]}"
            do
              echo $i
            done  
      - name: echo
        run:  |
          echo -e "\e[31>mSelect ran\e[0m"
          exit 1


  Preview_step1:
    needs:  [ Select] 
    if: ${{ inputs.Preview }}
    runs-on: ubuntu-latest
    steps:
      - name: echo
        run:  |
          echo -e "\e[32>mSelect ran\e[0m"
  Preview_step2:
    needs:  [ Preview_step1] 
    if: ${{ inputs.Preview && always() }}
    runs-on: ubuntu-latest
    steps:
      - name: echo
        run:  |
          echo -e "\e[32>mSelect ran\e[0m"          
  mail_success:
    needs: [Select,Preview_step1,Preview_step2]
    runs-on: ubuntu-latest
    if: always()
    steps:
      - name: control
        run:  |
          if [ "${{ needs.Select.result }}" == "failure" ]  \
          || [ "${{ needs.Preview_step1.result }}" == "failure" ]; then
            echo "Aborting the job"
            exit 1
          fi  
      - name: echo mail
        run:  |
          echo "sending mail"
  mail_failure:
    needs: [Preview_step1,Select,Preview_step2]
    runs-on: ubuntu-latest
    if: failure() || cancelled()
    steps:
      - name: echo mail
        run:  |
          echo "sending mail"          
